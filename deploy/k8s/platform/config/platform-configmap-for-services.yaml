apiVersion: v1
kind: ConfigMap
metadata:
  name: platform-config
  namespace: shopping
  labels:
    app: go-shopping-poc
    component: platform
data:
  # General Settings (shared by all services)
  LOG_LEVEL: "info"

  # Database Connection Pool Settings (shared by all services)
  DATABASE_MAX_OPEN_CONNS: "25"
  DATABASE_MAX_IDLE_CONNS: "25"
  DATABASE_CONN_MAX_LIFETIME: "5m"
  DATABASE_CONN_MAX_IDLE_TIME: "5m"
  DATABASE_CONNECT_TIMEOUT: "30s"
  DATABASE_QUERY_TIMEOUT: "60s"
  DATABASE_HEALTH_CHECK_INTERVAL: "30s"
  DATABASE_HEALTH_CHECK_TIMEOUT: "5s"

  # Kafka Configuration (shared by services that need it)
  KAFKA_BROKERS: "kafka-clusterip.kafka.svc.cluster.local:9092"

  # Outbox Pattern Configuration (shared by services that publish events)
  OUTBOX_BATCH_SIZE: "10"
  OUTBOX_DELETE_BATCH_SIZE: "10"
  OUTBOX_PROCESS_INTERVAL: "30s"
  OUTBOX_MAX_RETRIES: "3"

  # CORS Configuration (shared by services that need it)
  CORS_ALLOWED_ORIGINS: "http://localhost:4200,http://localhost:3000"
  CORS_ALLOWED_METHODS: "GET,POST,PUT,DELETE,PATCH,OPTIONS"
  CORS_ALLOWED_HEADERS: "Content-Type,Authorization,X-Requested-With"
  CORS_ALLOW_CREDENTIALS: "true"
  CORS_MAX_AGE: "3600"

  # MinIO Platform Settings (shared by services that need it)
  MINIO_ENDPOINT_KUBERNETES: "minio.minio.svc.cluster.local:9000"
  MINIO_ENDPOINT_LOCAL: "api.minio.local"
  MINIO_TLS_VERIFY: "false"

  # Keycloak Configuration (shared by authenticated services)
  KEYCLOAK_ISSUER: "http://keycloak.local/realms/pocstore-realm"
  KEYCLOAK_JWKS_URL: "http://keycloak.keycloak.svc.cluster.local:8080/realms/pocstore-realm/protocol/openid-connect/certs"
